{"version":3,"file":"index.js","sources":["../src/defaults.ts","../src/Context.tsx","../src/Child.tsx","../src/Container.tsx"],"sourcesContent":["import { SpringValue } from \"react-spring\";\n\n// Defaults\nexport const defaultSpring = { x: 0, y: 0 };\nexport const defaultSpringValue = { x: new SpringValue(0), y: new SpringValue(0) };\n","import { createContext, useContext } from \"react\";\nimport { defaultSpringValue } from \"./defaults\";\nimport { SpringPosition } from \"./interfaces\";\n\n// Parallax Context\nexport const OffsetContext = createContext<SpringPosition>(defaultSpringValue);\nexport const useParallaxOffset = () => useContext(OffsetContext);\n","import React, { useCallback } from \"react\";\nimport { animated } from \"react-spring\";\nimport { useParallaxOffset } from \"./Context\";\nimport { SpringPosition } from \"./interfaces\";\n\ninterface Props {\n  factorX?: number;\n  factorY?: number;\n  inverted?: boolean;\n  className?: string;\n  style?: React.CSSProperties;\n  children?: JSX.Element | JSX.Element[];\n}\n\nconst MouseParallaxChild = ({\n  factorX = 1,\n  factorY = 1,\n  inverted = false,\n  className,\n  style,\n  children,\n}: Props) => {\n  const offset = useParallaxOffset();\n  const calculateChildOffset = useCallback(\n    (offset: SpringPosition) => {\n      const calcX = (x: number) => x * factorX * (inverted ? -1 : 1);\n      const calcY = (y: number) => y * factorY * (inverted ? -1 : 1);\n      return { x: offset.x.to(calcX), y: offset.y.to(calcY) };\n    },\n    [factorX, factorY]\n  );\n\n  const divStyle = {\n    ...calculateChildOffset(offset),\n    ...style,\n  };\n\n  return (\n    <>\n      <animated.div {...{ className }} style={divStyle}>\n        {children}\n      </animated.div>\n    </>\n  );\n};\n\nexport { MouseParallaxChild };\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { SpringConfig, useSpring } from \"react-spring\";\nimport { OffsetContext } from \"./Context\";\nimport { defaultSpring } from \"./defaults\";\nimport { Position } from \"./interfaces\";\n\ninterface Props {\n  globalFactorX?: number;\n  globalFactorY?: number;\n  resetOnLeave?: boolean;\n  useWindowMouseEvents?: boolean;\n  inverted?: boolean;\n  springConfig?: SpringConfig;\n  enabled?: boolean;\n  containerStyle?: React.CSSProperties;\n  className?: string;\n  children: JSX.Element[] | JSX.Element;\n}\n\nconst MouseParallaxContainer = ({\n  globalFactorX = 1,\n  globalFactorY = 1,\n  resetOnLeave,\n  useWindowMouseEvents,\n  inverted,\n  springConfig,\n  enabled = true,\n  containerStyle,\n  className,\n  children,\n}: Props) => {\n  const [offset, offsetApi] = useSpring(() => ({\n    ...defaultSpring,\n    ...(springConfig ? { config: springConfig } : {}),\n  }));\n  const resetOffset = () => offsetApi.start(defaultSpring);\n\n  const [containerRef, setContainerRef] = useState<{\n    current: HTMLDivElement | null;\n  }>({ current: null });\n  const containerRefWithCallback = useCallback((node: any) => {\n    if (node !== null) {\n      setContainerRef({ current: node });\n    }\n  }, []);\n\n  const getMousePosition = useCallback(\n    (\n      event: React.MouseEvent<HTMLDivElement, MouseEvent> | MouseEvent\n    ): Position => {\n      const rect = containerRef.current\n        ? containerRef.current.getBoundingClientRect()\n        : { left: 0, top: 0 };\n      return { x: event.clientX - rect.left, y: event.clientY - rect.top };\n    },\n    [containerRef]\n  );\n\n  const mouseMovementHandler = useCallback(\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent> | MouseEvent) => {\n      if (containerRef.current) {\n        const containerHeight = containerRef.current.clientHeight;\n        const containerWidth = containerRef.current.clientWidth;\n        const mousePosition = getMousePosition(event);\n        const offsetRelativeToCenter: Position = {\n          x:\n            (containerWidth / 2 - mousePosition.x) *\n            globalFactorX *\n            (inverted ? -1 : 1),\n          y:\n            (containerHeight / 2 - mousePosition.y) *\n            globalFactorY *\n            (inverted ? -1 : 1),\n        };\n        offsetApi.start(offsetRelativeToCenter);\n      }\n    },\n    [containerRef, getMousePosition, inverted]\n  );\n\n  // Use window event handler when useWindowMouseEvents is enabled\n  useEffect(() => {\n    if (enabled && useWindowMouseEvents && containerRef.current) {\n      window.addEventListener(\"mousemove\", mouseMovementHandler, false);\n      if (resetOnLeave) {\n        window.addEventListener(\"mouseout\", resetOffset, false);\n      }\n    }\n    return () => {\n      if (enabled && useWindowMouseEvents && containerRef.current) {\n        window.removeEventListener(\"mousemove\", mouseMovementHandler, false);\n        if (resetOnLeave) {\n          window.removeEventListener(\"mouseout\", resetOffset, false);\n        }\n      }\n    };\n  }, [\n    containerRef,\n    mouseMovementHandler,\n    resetOnLeave,\n    useWindowMouseEvents,\n    enabled,\n  ]);\n\n  const useMouseMoveHandler = enabled && !useWindowMouseEvents;\n  const useMouseLeaveHandler = enabled && !useWindowMouseEvents && resetOnLeave;\n  const divEvents = {\n    onMouseMove: useMouseMoveHandler ? mouseMovementHandler : undefined,\n    onMouseLeave: useMouseLeaveHandler ? resetOffset : undefined,\n  };\n\n  return (\n    <OffsetContext.Provider value={offset}>\n      <div\n        id=\"mouse-parallax-container\"\n        ref={containerRefWithCallback}\n        style={{ overflow: \"hidden\", position: \"relative\", ...containerStyle }}\n        {...{ className }}\n        {...divEvents}\n      >\n        {children}\n      </div>\n    </OffsetContext.Provider>\n  );\n};\n\nexport { MouseParallaxContainer };\n"],"names":["defaultSpring","x","y","defaultSpringValue","SpringValue","OffsetContext","createContext","useParallaxOffset","useContext","_a","_b","factorX","_c","factorY","_d","inverted","className","style","children","offset","calculateChildOffset","useCallback","to","divStyle","React","createElement","Fragment","animated","div","__assign","globalFactorX","globalFactorY","resetOnLeave","useWindowMouseEvents","springConfig","enabled","containerStyle","_e","useSpring","config","offsetApi","resetOffset","start","_f","useState","current","containerRef","setContainerRef","containerRefWithCallback","node","getMousePosition","event","rect","getBoundingClientRect","left","top","clientX","clientY","mouseMovementHandler","containerHeight","clientHeight","containerWidth","clientWidth","mousePosition","offsetRelativeToCenter","useEffect","window","addEventListener","removeEventListener","divEvents","onMouseMove","undefined","onMouseLeave","Provider","value","id","ref","overflow","position"],"mappings":"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"}